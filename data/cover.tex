
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
\secretlevel{保密} 
\secretyear{2}

\ctitle{基于弹性波模式解耦的全波形反演方法}

% 按照申请工学学位设计。如有其它需要，请修改相应文字。
\makeatletter
  \iftongji@doctor
    \cdegree{博士}
  \else
    \iftongji@master
      \cdegree{理学硕士}
    \fi
  \fi

\makeatother

\cdepartment{同济大学海洋学院}

\cmajorfirst{固体地球物理}

\degtype{理学}

\cauthor{王腾飞}

\cstnr{1110701}

\csupervisor{程玖兵 教授}

% 如果没有副指导老师或者联合指导老师，把各自{}中内容留空即可。

\cassosupervisor{}

\ccosupervisor{}

% 日期自动生成，如果你要自己写就改这个cdate
%\cdate{\CJKdigits{\the\year}年\CJKnumber{\the\month}月}
\makeatletter
  \iftongji@doctor
    \edegree{Doctor of Philosophy}
  \else
    \iftongji@master
      \edegree{Master of Science}
    \fi
  \fi

\makeatother

%\cfunds{自然基金项目(No.123456789)}

%\efunds{(Supported by the Natural Science Foundation of China for\\ Distinguished
%         Young Scholars, Grant No.123456789)}

\etitle{Elastic full waveform inversion based on wave mode decomposition}

\edepartment{School of Ocean and Earth Science}

\edispline{Natural Science}

\emajorfirst{Solid Geophysics}
%\emajorsecond{TONGJILUG}

\eauthor{Tengfei Wang}

\esupervisor{Prof. Jiubing Cheng}

% 这个日期也会自动生成，你要改么？
% \edate{May, 2009}

% 定义中英文摘要和关键字
\begin{cabstract}
	通过地震数据定量化地估计弹性参数甚至岩石物理参数是地震勘探的重要目标。随着计算能力的快速提升以及
	宽方位、长偏移距、宽频带的地震数据采集技术的成熟，旨在估计全频带速度模型的全波形反演方法(FWI)
	成为勘探地震学中的有力工具。然而FWI无法一劳永逸地解决问题，近几十年来，
	为了解决FWI受到初始模型不够好，数据中缺乏低频，子波估计不准，噪音影响等因素的困扰，许多学者发展了分频率、分偏移
	距、分散射角等多尺度策略来降低非线性程度。此外在弹性介质中，
	不同参数扰动的偏导数波场在特定散射角范围内重叠导致参数耦合效应，并且不同波模式转换以及多分量数据的复杂性
	进一步增加反问题的非线性程度。
	为了重建不同波数频带的模型，本文围绕模式解耦这一数据分离工具，从弹性波全波形反演（EFWI）、弹性波波动方程反射走时反演
	（E-WERTI）以及弹性波最小二乘逆时偏移（E-LSRTM）出发，分别尝试恢复全波数、中低波数以及高波数成分的弹性模型参数，进而形成弹性波
	反演中较完整的工作流程体系。

%	在第二章中主要讨论EFWI中模式解耦对压制参数耦合效应的作用。
	EFWI通过最小化观测到的多分量数据与正演模拟数据
	之间的残差来获得高分辨率的地下弹性参数模型。由于Hessian矩阵的显式计算与求逆代价十分
	巨大，实际应用中的大规模问题通常采用梯度类的最优化方法而非基于Hessian的方法。然而多参数
	反演中，参数耦合效应会引起不同参数间梯度的串扰，进而会严重影响反演的收敛速度与精度。
%	近期，弹性波模式解耦的方法被用来对梯度进行预条件从而降低EFWI过程中的参数耦合
%	问题。
	第二章提出了一种模式解耦的EFWI方法，该方法在时间域通过正传
	与解耦的反传波场之间的互相关来获得梯度。基于解耦的Frech$\acute{e}t$导数，我们通过分析
	Hessian矩阵和分辨率矩阵，并对比常规共轭梯度法、Gauss-Newton法和模式解耦法梯度之间的异同来解释模式解耦的物理机制。简单流体饱和模
	型与Marmousi-II模型的数值实例，证明了模式解耦的预条件共轭梯度法可以降低P-波和S-波速度（$V_p$和$V_s$）
	之间的参数耦合，在不涉及Hessian计算的同时获得快速的收敛。

	利用弹性反射波波形反演（ERWI）可以更新中深层模型的中低波数成分，从而为EFWI提供更好的初始模型。
	然而波形匹配的ERWI也同样会面临周波跳跃的问题。相比于波形匹配的目标函数，反射走时目标函数与背景速度模型之间存在
	更好的线性关系，因此第三章中采用E-WERTI的方式，
	通过DIW算法（Dynamic image warping）来提取走时残差并以此建立目标函数，
	可以有效地回避周波跳跃。
	文中采用基于模式解耦的两步反演策略，首先采用PP波数据反演$V_p$，然后采用反演好的$V_p$通过PS波反演$V_s$。
	地面P/S数据分离+延拓空间弹性波模式解耦可以有效地分离出P或S波数据从而实现分步反演，这将有效降低反演的非线性程度。
	反射波波路径核函数分析
	解释了模式解耦在反射波反演中，通过分离不同波模式的反射路径来压制串扰的重要作用。
	倾角滤波约束可以使得反演快速收敛到具有地质意义的模型。
	为了降低反演的多解性、保证反演能够获得具有地质意义的模型，本章加入成像结果的局部倾角约束来进行模型正则化。
	文中采用Sigsbee2A模型来
	验证E-WERTI方法以及反演策略的有效性，并用EFWI检验E-WERTI模型的准确性。

	E-LSRTM旨在通过拟合反射波振幅信息来反演弹性参数模型的高波数成分，可以视为线性的EFWI问题。
	由于实际反射数据与Born数据之间存在差异，因此在E-LSRTM中最好能匹配反射数据与背景波场之间的残差。常规E-LSRTM可以通过多次迭代部分地压制参数间的耦合
	效应。模式解耦则可以在计算梯度时通过分离出S波梯度，使得E-LSRTM中S波速度扰动的反演等价于单参数反演。由此在第四章中，我们针对不同情况设计了相应
	的反演策略来压制参数耦合。在$V_p$较少受$V_s$耦合影响时，采用梯度解耦双参数同时反演；而在$V_p$与$V_s$强烈相互影响时，先采用解耦通过S波
	反演好$V_s$，然后反演$V_p$，这样可以进一步压制$V_p$所受到的来自$V_s$的耦合影响。

%	为了恢复弹性介质模型中的不同波数成分，本文
	本文针对弹性波中的反演问题，分别从EFWI，E-WERTI以及E-LSRTM
	三个方面入手来恢复不同波数成分的弹性参数模型。在常规多尺度策略的基础上，通过空间模式解耦和地面P/S数据分离方式
	获取P或S数据子集，分析不同模式的P/S波数据在Frech$\acute{e}t$导数、
	Hessian和分辨率矩阵以及Born反射波路径核函数的计算等反演关键问题中的影响，
	设计出针对不同反演阶段所适用的梯度与条件方式和多尺度策略，从而降低弹性波反演的参数耦合、非线性等问题，
	进而形成完整的弹性波反演体系，获得从浅部到深部更准确的弹性参数估计。


\end{cabstract}

\ckeywords{全波形反演，Hessian和分辨率矩阵，参数耦合，波动方程反射走时反演，反射波路径核函数，最小平方逆时偏移，弹性波，模式解耦}

\begin{eabstract}
	The aim of seismic exploration is to estimate the elastic parameters or rock properties
	quantitively                                              
	with the recording data on the surface. With the developement of 
	high-performance computation ability and the
	maturation of wide-azimuth, long-offset and broadband data accquisition 
	technology, full waveform inversion (FWI) becomes a powerful tool to recover the full
	 wavenumber spectrum of the subsurface. However, FWI can not provide the perfectly estimated
	model
	once and for all due to the obstacles such as bad initial models,
	insufficiency of low frequency component in the data, inaccurately estimated source
	wavelet, low sigal/noisy ratio in the data and so on,
	In order to rebuild the model with different wavenumber spectrum, elastic full waveform
	inversion (EFWI), elastic wave equation 
	reflected traveltime inversion (E-WERTI) and elastic least square reverse time
	migration (E-LSRTM) are implemented with the help of wave mode decomposition, in which we
	try to recover the full wavenumber, the low and intermediat wavenumber
	and the high wavenumber spectrum of the elastic model, respectively.

Elastic full waveform inversion (EFWI) aims to reduce the misfit between recorded and modelled multi-component
seismic data for deducing a detailed model of elastic parameters in the subsurface.
Because the explicit computation and inversion of the Hessian matrix
is extremely resource intensive,
a gradient-based (rather than Hessian-based) minimization is generally applied for large-scale applications.
However, the multi-parameter trade-off effects cause cross-talks in the computed gradients and
thus severely affect the convergence and the quality of the inverted model.
Recently, preconditioning the gradients based on elastic wave mode decomposition
has been suggested for mitigating the parameter trade-offs in the EFWI process.
In this paper, we propose a mode decomposition (MD)-based EFWI approach, in which the preconditioned gradients
are obtained through the cross-correlation of the forward and
decomposed adjoint wavefields in the time domain.
Based on the decomposed Frech{$\acute{e}$}t derivatives,
we explain the mechanism of this approach through analyses of Hessian and resolution matrices
and comparisons with the Gauss-Newton gradients.
Numerical examples of a simple fluid-saturated model and the Marmousi-II model
demonstrate that the MD-based preconditioned conjugate-gradient approach
can mitigate the trade-off between the P- and S-wave velocities and achieve fast
convergence without any Hessian-involved calculations.

Elastic reflection waveform inversion (ERWI) utilize the reflections to update the low and
intermediate wavenumber in the
deeper part of model, which can provide good initial models for EFWI. However, ERWI suffers from
the cycle-skipping problem because of the objective function fitting waveform. Since taveltime
information relates to the background model more linearly, the cycle-skipping will be less severe
compared with waveform norm. Thus, in the third chapter we use the $L_2$ norm of the traveltime
residual extracted by the Dynamic image warping (DIW) as objective function in the manner of
WERTI. 
A two-step inversion strategy is adopted. Firstly, PP reflections are used to invert $V_p$. 
After that PS reflections are used to invert $V_s$ based on the well recoverd $V_p$. Surface P/S
separation and spatial wave mode decomposition provide P or S wave data effectively, which helps
to  reduce the nonlinearty of inversion greatly.
The kernel of reflection wavepath proves that mode decomposition can surpress the artifacts in
the reflection inversion. The local dip-dependent smooth filter ensures the inversion converging to
a
geological model. Finally, numerical example of Sigsbee2A model validates the effectivenss of the 
algorithms and strategies for E-WERTI, whose results also are tested through EFWI.

E-LSRTM is the linearied EFWI aimming to fit the waveform of reflections with the inverted
high-wavenumber perturbations. Due to the energy difference between Born and reflection data, it is
more suitable to match the residual between reflection data and the background data during E-LSRTM.
Conventional
E-LSRTM can sligthly mitigate the parameter trade-offs through iterations. While mode decomposition
isolates the S-wave part in  gradient calculation, which makes the inversion of S-wave velocity
perturbation a mono-parameter inversion to help mitigate the trade-offs. In the fourth chapter, we
design different inversion strategies to cope with the different situations. When $V_p$ is little
affected by $V_s$, we invert the two parameter simultaneously with mode decomposition; when $V_p$
and $V_s$ couple with each
other severely, we recommand inverting $V_s$ firstly followed by $V_p$ inversion to further mitigate
the trade-offs from $V_s$ during the $V_p$ inversion.

In this paper, we focus on the mode-decomposition-based inversion methods, select different strategy
according to the requirement of different inversion stage to reduce the nonlinearty, trade-off
effects and other problems and finally rebuild the elastic model from shallow to
deep more accurately. 

\end{eabstract}

%\ckeywords{全波形反演，Hessian和分辨率矩阵，参数耦合，波动方程反射走时反演，反射波路径核函数，最小平方逆时偏移，弹性波，模式解耦}
\ekeywords{Full waveform inversion, Hessian and resolution matrix, parameter trade-off, 
	wave equation reflected traveltime inversion, kernel of reflection wavepath, least-square RTM,
	Elasticity, Mode decomposition}
